<!DOCTYPE html>
<link rel="shortcut icon" href="//monitor.sz.lan/meal_planner/static/favicon.png">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="//monitor.sz.lan/resources/w3.css">
<link rel="stylesheet" href="//monitor.sz.lan/resources/w3-colors-2017.css">
<link rel="stylesheet" href="//monitor.sz.lan/resources/w3-colors-highway.css">
<link rel="stylesheet" href="//monitor.sz.lan/resources/font-awesome.min.css">
<script src="//monitor.sz.lan/resources/monitor.js"></script>
<html>
<head>
<title>每日食谱</title>
  <script>
    window.onload = function() { logUserInteractions('[meal-planner] load');  };
    window.onunload = function() { logUserInteractions('[meal-planner] unload'); };
  </script>
</head>
<body>
<script>
function accordionHandler(id) {
  var x = document.getElementById('accordion-' + id.toString());
  if (x.className.indexOf("w3-show") == -1) {
    x.className += " w3-show";
    document.getElementById('small-triangle-' + id.toString()).innerHTML = '▴';
    logUserInteractions('[meal-planner] accordion ' + id.toString() + ' shown');
  } else { 
    x.className = x.className.replace(" w3-show", "");
    document.getElementById('small-triangle-' + id.toString()).innerHTML = '▾';
    logUserInteractions('[meal-planner] accordion ' + id.toString() + ' hidden');
  }
}
function copyMealPlanOfToday() {
  for (i = 0; i < {{meal_plan_items|length}}; i++) {
    document.getElementById('input-3' + i.toString()).value = document.getElementById('input-2' + i.toString()).value;
  }
}
</script>
<div class="w3-container w3-responsive" style="max-width: 50em; padding:0.75rem; display: block; margin-left: auto; margin-right: auto;">
	{%for i in range(0, day_strings|length)%} 
  <button onclick="accordionHandler('{{i}}')" class="w3-button w3-block w3-left-align w3-green" style="margin-top:0.35em;">
  {{day_strings[i][2]}}食谱({{day_strings[i][3]}})<span id="small-triangle-{{i}}" class="w3-right">{% if i == 1 or i == 2 %} ▴ {% else %} ▾ {% endif %}</span></button>  
  <div id="accordion-{{i}}" class="w3-hide {% if i == 2 or i == 3 %} w3-show {% endif %} w3-container w3-card-4">
    <form class="w3-container" action="https://monitor.sz.lan/meal_planner/" method="post" style="padding:8px;">
      <input type="hidden" name="date" value="{{i}}"> 
      {%for j in range(0, meal_plans[i]|length)%} 
      <div><p class="w3-text-green" style="margin-top:0.5em; margin-bottom:0.1em"><b>{{meal_plan_items_cn[j]}}</b></p></div>
      <div class="w3-cell-row">
        <div class="w3-cell"><input id="input-{{i}}{{j}}" class="w3-input" name="{{meal_plan_items[j]}}" value="{{meal_plans[i][j][0]}}"></div>
        <div class="w3-cell">
            <select {% if meal_plans[i][j][1] != 'B' and meal_plans[i][j][1] != 'C' %} class="w3-select w3-text-green" {% elif meal_plans[i][j][1] == 'B' %} class="w3-select" style="color:#f2552c;" {% elif meal_plans[i][j][1] == 'C' %} class="w3-select w3-text-red" {% endif %} style="font-weight:bold;" name="{{meal_plan_items[j]}}_review">
              <option class="w3-text-green" style="font-weight:bold;" {% if meal_plans[i][j][1] != 'B' and meal_plans[i][j][1] != 'C' %} selected {% endif %} value="A">A</option>
              <option style="font-weight:bold;color:#f2552c;" {% if meal_plans[i][j][1] == 'B' %} selected {% endif %} value="B">B</option><!--w3-2017-flame-->
              <option class="w3-text-red" style="font-weight:bold;" {% if meal_plans[i][j][1] == 'C' %} selected {% endif %} value="C">C</option>
            </select>
        </div>
      </div>
      {%endfor%}
      <input class="w3-button w3-border w3-highway-green w3-right w3-margin-bottom" style="margin-top:0.85rem" type="submit" onclick="logUserInteractions('[meal-planner] submit new meal plan');" value="提交">
      {% if i == 3 %}<input class="w3-button w3-border w3-highway-green w3-right w3-margin-bottom" style="margin-top:0.85rem;" type="button" onclick="copyMealPlanOfToday(); logUserInteractions('[meal-planner] copy today\'s meal plan');" value="沿用今日">{% endif %}
    </form>    
  </div>
	{%endfor%}
  <div class="w3-card-4" style="margin-top:1rem;" >
    <header class="w3-container w3-green">
      <h3>备忘</h3>
    </header>  
    <div class="w3-container">
      <form action="https://monitor.sz.lan/meal_planner/" method="post" style="padding:8px;" id="form-notes">
        <div><textarea rows="5" name="notes" form="form-notes" style="width:99%;">{{notes}}</textarea></div>
        <input class="w3-button w3-border w3-highway-green w3-right w3-margin-bottom" style="margin-top: 0.85rem" type="submit" onclick="logUserInteractions('[meal-planner] submit new notes');" value="提交">
      </form>
    </div>  
  </div>
	<div class="w3-card-4" style="margin-top:1rem;" >
    <header class="w3-container w3-green">
      <h3>黑名单</h3>
    </header>  
    <div class="w3-container">
      <form action="https://monitor.sz.lan/meal_planner/" method="post" style="padding:8px;" id="form-blacklist">
        <div class="w3-container" style="margin-top:1rem;"><span style="color:#ff0000;"><!--pure-red--><b>避免</b>食用</span><textarea rows="12" name="banned_items" form="form-blacklist" style="width:99%;">{{banned_items}}</textarea></div>
        <div class="w3-container"><span style="color:#f2552c;"><!--w3-2017-flame--><b>谨慎</b>食用</span><textarea rows="10" name="limited_items" form="form-blacklist" style="width:99%;">{{limited_items}}</textarea></div>
        <input class="w3-button w3-border w3-highway-green w3-right w3-margin-bottom" style="margin-top: 0.85rem" type="submit" onclick="logUserInteractions('[meal-planner] submit new blacklist items');" value="提交">
      </form>      
    </div>  
  </div>
  <div id="msg_box" class="w3-modal" style="display:block">
    <div class="w3-modal-content w3-animate-top">
      <header class="w3-container w3-green"> 
        <h4>重要提醒</h4>
      </header>
      <div class="w3-container">
        <p id="msg_body"><h3>记得按时服用<b>胰酶/复合酶</b>。</h3></p>
        <p><button onclick="document.getElementById('msg_box').style.display='none';" class="w3-right w3-button w3-green">确定</button></p>
      </div>
    </div>
  </div>

</div>

</body>
</html>